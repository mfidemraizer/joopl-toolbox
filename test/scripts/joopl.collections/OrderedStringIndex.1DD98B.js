"use strict";(function(){$namespace.register("joopl.collections",function(){var n=this;this.declareClass("OrderedStringIndex",{inherits:n.Index,ctor:function(t){this.base.ctor(t);this._.partitions=new n.List;this._.vocalPartitionRegEx=new RegExp("^(a|e|i|o|u|aa|ae|ai|ao|au|ea|ee|ei|eo|eu|ia|ie|io|iu|oa|oe|oi|oo|ou|ua|ue|ui|uo|uu)","i");this._.consonantPartitionRegEx=new RegExp("^(b|c|Ã§|d|f|g|h|j|k|l|m|n|p|q|r|s|t|v|w|x|y|z)","i");this._.numericAndSymbol=new RegExp("^[A-Za-z]","i");this.initialize()},members:{get enumerator(){return this.source.enumerator},get vocalPartitionRegEx(){return this._.vocalPartitionRegEx},get consonantPartitionRegEx(){return this._.consonantPartitionRegEx},get partitions(){return this._.partitions},initialize:function(){var r="abcdefghijklmnopqrstuvwxyz",i="aeiou",t=null,u=null,f,e;this.partitions.add({id:"other",store:new n.List});for(f in r)if(t=r[f],i.indexOf(t)==0){this.partitions.add({id:t,store:new n.List});for(e in i)u=i[e],this.partitions.add({id:t+u,store:new n.List})}else this.partitions.add({id:t,store:new n.List})},findPartition:function(n){var t=null,i=this.vocalPartitionRegEx.test(n);return t=i?this.vocalPartitionRegEx.test(n.toLowerCase())?n.length>1&&this.vocalPartitionRegEx.test(n.substring(1,1).toLowerCase())?n.substring(0,2):n[0]:n[0]:this.consonantPartitionRegEx.test(n[0].toLowerCase())?n[0]:"other",t=t.toLowerCase(),this.partitions.singleOrNull(function(n){return n.id==t})},onDataChange:function(t){switch(t.changeKind){case n.ObservableChange.added:this.onAdded({item:t.item});break;case n.ObservableChange.replaced:this.onReplaced({item:t.item});break;case n.ObservableChange.removed:this.onRemoved({item:t.item})}},onAdded:function(n){var i=this.property,r=n.item[i],u=this.propertySelectorFunc,t=this.findPartition(r);if(this.unique)if(t.store.count(function(n){return n[i]===r})==0)t.store.add(n.item);else throw new Error(new $global.joopl.ArgumentException({argName:"item",reason:"Unique index violation"}));else t.store.add(n.item)},onReplaced:function(n){var t=this.findPartition(n.item),i;if(this.unique&&t.store.count(function(t){return t.value==n.item})>0)throw new Error(new $global.joopl.ArgumentException({argName:"item",reason:"Unique index violation"}));i=t.store.indexOf(n.oldItem);t.store.replaceAt(i,n.item)},onRemoved:function(n){var t=this.findPartition(n.item),i=t.store.indexOf(n.item);t.store.removeAt(replacedItemIndex)},forEach:function(){throw new Error(new $global.joopl.NotImplementedException({memberName:"OrderedStringIndex.forEach"}));},reverse:function(){throw new Error(new $global.joopl.NotImplementedException({memberName:"OrderedStringIndex.reverse"}));},single:function(n,t){var i=this.findPartition(n[this.property]);return i.store.single(t.bind(n[this.property]))},singleOrNull:function(n,t){var i=this.findPartition(n[this.property]);return i.store.singleOrNull(t.bind(n[this.property]))},first:function(n,t){var i=this.findPartition(n[this.property]);return i.store.first(t.bind(n[this.property]))},firstOrNull:function(n,t){var i=this.findPartition(n[this.property]);return i.store.firstOrNull(t.bind(n[this.property]))},last:function(n,t){var i=this.findPartition(n[this.property]);return i.store.last(t.bind(n[this.property]))},lastOrNull:function(n,t){var i=this.findPartition(n[this.property]);return i.store.lastOrNull(t.bind(n[this.property]))},count:function(n,t){var i=this.findPartition(n[this.property]);return i.store.count(t.bind(n[this.property]))},where:function(n,t){var i=this.findPartition(n[this.property]);return i.store.where(t.bind(n[this.property]))}}})})})()
